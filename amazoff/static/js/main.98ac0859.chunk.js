(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(72),l=a.n(s);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(3),o={apiKey:"AIzaSyCB00wchyxzKiAuC7zD10eS0WSrXEQLVbU",authDomain:"cis371semesterproject.firebaseapp.com",databaseURL:"https://cis371semesterproject.firebaseio.com",projectId:"cis371semesterproject",storageBucket:"cis371semesterproject.appspot.com",messagingSenderId:"54214005334"},i=a(5),u=a(6),d=a(9),m=a(7),h=a(8),p=a(10),f=a(11);c.apps.length||c.initializeApp(o);var E,g,b=function(){return r.a.createElement("input",{type:"text",className:"search",onFocus:v,placeholder:"Search..."})},v=function(){return r.a.createElement("div",{className:"searchResults",id:"searchResults"},r.a.createElement("ul",null,r.a.createElement("li",null,"Search not found.",r.a.createElement("br",null),r.a.createElement("sub",null,"Try another search term."))))},C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).componentWillUnmount=function(){a._isMounted=!1,a.setState({user:E})},a.state={user:{},loggedIn:!1},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,(this._isMounted=!0)&&c.auth().onAuthStateChanged(function(e){(E=e)?this.setState({user:E,loggedIn:!0}):this.setState({loggedIn:!1})}.bind(this))}},{key:"render",value:function(){return this.state.loggedIn&&"/"===this.props.location.pathname?r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/"},r.a.createElement("img",{src:"https://github.com/Muna72/CIS371_GroupProject/blob/master/eshop-app/src/img/amazoff.gif?raw=true",alt:"logo",id:"logo"}))),r.a.createElement(b,null),r.a.createElement("div",{className:"menuItems"},r.a.createElement("div",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/Cart/"},"Cart")),r.a.createElement("li",null,r.a.createElement(p.b,{to:"/Account/"},"Account"))))),null):this.state.loggedIn&&"/"!==this.props.location.pathname?r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/"},r.a.createElement("img",{src:"https://github.com/Muna72/CIS371_GroupProject/blob/master/eshop-app/src/img/amazoff.gif?raw=true",alt:"logo",id:"logo"}))),r.a.createElement("div",{className:"menuItems"},r.a.createElement("div",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/Cart/"},"Cart")),r.a.createElement("li",null,r.a.createElement(p.b,{to:"/Account/"},"Account"))))),null):this.state.loggedIn||"/"!==this.props.location.pathname?r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/"},r.a.createElement("img",{src:"https://github.com/Muna72/CIS371_GroupProject/blob/master/eshop-app/src/img/amazoff.gif?raw=true",alt:"logo",id:"logo"}))),r.a.createElement("div",{className:"menuItems"},r.a.createElement("div",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/SignIn/"},"Sign In"))))),null):r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/"},r.a.createElement("img",{src:"https://github.com/Muna72/CIS371_GroupProject/blob/master/eshop-app/src/img/amazoff.gif?raw=true",alt:"logo",id:"logo"}))),r.a.createElement(b,null),r.a.createElement("div",{className:"menuItems"},r.a.createElement("div",null,r.a.createElement("li",null,r.a.createElement(p.b,{to:"/SignIn/"},"Sign In"))))),null)}}]),t}(n.Component),w=Object(f.f)(C),y=a(35),O=a(20),S=a.n(O),j=[],N=null,I=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getCurrentUser=function(){c.auth().onAuthStateChanged(function(e){e&&a.setState({user:c.auth().currentUser})})},a.addToCart=function(e,t){t>0&&(a.state.user&&0===Object.keys(a.state.user).length?a.setState({redirect:!0}):(a.writeUserData(a.state.user,e,t),a.resetQuantity()))},a.handleInputChange=function(e,t){a.setState(Object(y.a)({},t,e.target.value))},a.state={redirect:!1,products:[],user:{},quantity:1},a._isMounted=!1,a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this._isMounted&&this.getCurrentUser();var t=c.database().ref().child("products");j=[],t.on("value",function(t){j=[],t.forEach(function(e){var t=e.val();t.key=parseInt(e.key),j.push(t)}),e._isMounted&&e.setState({products:j})})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"writeUserData",value:function(e,t,a){c.database().ref("/products/"+t).child("onHand").once("value").then(function(n){n.val()<a?alert("Not enough remain!"):c.database().ref("customers/"+e.uid).child("cart").update(Object(y.a)({},t,parseInt(a,10)))})}},{key:"resetQuantity",value:function(){this.setState({quantity:1})}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(f.a,{push:!0,to:"/SignIn/"}):(N=null,N=j.map(function(t,a){return r.a.createElement("div",{key:a,className:"storeItem"},r.a.createElement("div",{className:"thumbnailContainer"},r.a.createElement(p.b,{to:"/Product/".concat(t.key)},r.a.createElement("img",{src:t.imgUrl,className:"thumbnail",alt:""}))),r.a.createElement("div",{className:"itemActions"},r.a.createElement("input",{type:"number",min:"0",max:t.onHand,value:e.state.quantity,onChange:function(t){return e.handleInputChange(t,"quantity")}}),r.a.createElement("button",{onClick:function(){return e.addToCart(t.key,e.state.quantity)}},"Add to Cart"),r.a.createElement("p",{className:"quantityRemaining"},"Quantity Remaining: ",t.onHand)),r.a.createElement("div",{className:"itemDetails"},r.a.createElement("p",null,r.a.createElement("b",null,t.name)),r.a.createElement(S.a,{value:t.price,displayType:"text",thousandSeparator:!0,prefix:"$",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return r.a.createElement("div",null,e)}})))}),r.a.createElement("div",null,N))}}]),t}(n.Component),A=function(){return r.a.createElement("div",{className:"main"},r.a.createElement(I,null))},k=a(4),P=c.database().ref(),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getCurrentUser=function(){var e=Object(k.a)(Object(k.a)(a));c.auth().onAuthStateChanged(function(t){t?(g=t,e.setState({user:g},e.getUserInfo)):e.setState({user:{}},e.signOut)})},a.getUserInfo=function(){if(g){var e=Object(k.a)(Object(k.a)(a));return c.database().ref("/customers/"+a.state.user.uid).once("value").then(function(t){var a=t.val();e.setState({name:a.name,shippingAddress:a.shippingAddress,city:a.shippingAddress.city,country:a.shippingAddress.country,state:a.shippingAddress.state,streetAddress:a.shippingAddress.streetAddress,zip:a.shippingAddress.zip})})}a.signOut()},a.handleInputChange=function(e,t){a.setState(Object(y.a)({},t,e.target.value))},a.signOut=function(){var e=Object(k.a)(Object(k.a)(a));c.auth().signOut().then(function(){e.setState({user:{},redirect:!0})}).catch(function(e){console.log(e)})},a.state={redirect:!1,user:{},name:"",shippingAddress:{},city:"",country:"",state:"",streetAddress:"",zip:""},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.getCurrentUser()}},{key:"removeAccount",value:function(){if(!0===window.confirm("Are you sure you want to PERMENANTLY delete account and all user data?")){P.child("customers").child(this.state.user.uid).remove();var e=c.auth().currentUser,t=c.auth.EmailAuthProvider.credential(this.state.user.email,"firebase");e.reauthenticateWithCredential(t),e.delete().then(function(){alert("Account Sucessfully deleted")}).catch(function(e){alert("An error occured - action aborted"+e)}),this.setState({redirect:!0})}}},{key:"updateInfo",value:function(){console.log("updating info for ",this.state.user.email);var e={};e["/customers/"+this.state.user.uid+"/name/"]=this.state.name,e["/customers/"+this.state.user.uid+"/shippingAddress/city"]=this.state.city,e["/customers/"+this.state.user.uid+"/shippingAddress/country"]=this.state.country,e["/customers/"+this.state.user.uid+"/shippingAddress/state"]=this.state.state,e["/customers/"+this.state.user.uid+"/shippingAddress/streetAddress"]=this.state.streetAddress,e["/customers/"+this.state.user.uid+"/shippingAddress/zip"]=this.state.zip,console.log(c.database().ref().update(e))}},{key:"changePassword",value:function(){var e=this.state.newPassword;this.state.newPassword===this.state.confirmPassword?c.auth().signInWithEmailAndPassword(this.state.user.email,this.state.currentPassword).then(function(t){c.auth().currentUser.updatePassword(e).then(function(){alert("Password updated successfully")}).catch(function(e){alert("Error: "+e)})}).catch(function(e){alert("Error: "+e)}):alert("New password fields do not match. Please re-enter new password.")}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(f.a,{push:!0,to:"/"}):g&&g.email?r.a.createElement("div",{className:"main"},r.a.createElement("h1",{id:"welcome"},"Welcome, ",this.state.user.email,"!"),r.a.createElement("h2",{id:"acctInfo"},"Account Information"),r.a.createElement("div",{id:"userInfoForm"},r.a.createElement("label",null,"Name:"),r.a.createElement("input",{type:"text",id:"name",size:"35",defaultValue:this.state.name,onChange:function(t){return e.handleInputChange(t,"name")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"address"},"Street Address:"),r.a.createElement("input",{type:"text",id:"address",size:"35",defaultValue:this.state.shippingAddress.streetAddress,onChange:function(t){return e.handleInputChange(t,"streetAddress")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"city"},"City:"),r.a.createElement("input",{type:"text",id:"city",size:"35",defaultValue:this.state.shippingAddress.city,onChange:function(t){return e.handleInputChange(t,"city")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"state"},"State:"),r.a.createElement("input",{type:"text",id:"state",size:"35",defaultValue:this.state.shippingAddress.state,onChange:function(t){return e.handleInputChange(t,"state")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"zip"},"Zip Code:"),r.a.createElement("input",{type:"text",id:"zip",size:"35",defaultValue:this.state.shippingAddress.zip,onChange:function(t){return e.handleInputChange(t,"zip")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"country"},"Country:"),r.a.createElement("input",{type:"text",id:"country",size:"35",defaultValue:this.state.shippingAddress.country,onChange:function(t){return e.handleInputChange(t,"country")}}),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"submit",value:"Submit Changes",onClick:function(){e.updateInfo()}}),r.a.createElement("h3",{className:"acctTitles"},"Change Your Password"),r.a.createElement("label",{htmlFor:"password"},"Current Password:"),r.a.createElement("input",{type:"text",id:"password",onChange:function(t){return e.handleInputChange(t,"currentPassword")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"newPassword"},"New Password:"),r.a.createElement("input",{type:"text",id:"newPassword",onChange:function(t){return e.handleInputChange(t,"newPassword")}}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm New Password:"),r.a.createElement("input",{type:"text",id:"confirmPassword",onChange:function(t){return e.handleInputChange(t,"confirmPassword")}}),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",value:"Update",className:"submit",onClick:function(){e.changePassword()}}),r.a.createElement("h3",{className:"acctTitles"},"Delete Account"),r.a.createElement("input",{type:"submit",value:"Delete",className:"submit",onClick:function(){e.removeAccount()}})),r.a.createElement("div",{className:"sidenav"},r.a.createElement("a",{href:"/Orders"},"My Orders"),r.a.createElement("br",null),r.a.createElement("a",{href:"/Cart"},"Current Cart"),r.a.createElement("p",{onClick:this.signOut},"Logout"),r.a.createElement("br",null))):r.a.createElement("div",{className:"main"},r.a.createElement("p",null,"Loading..."),r.a.createElement("div",{className:"sidenav"},r.a.createElement("a",{href:"/Orders"},"My Orders"),r.a.createElement("br",null),r.a.createElement("a",{href:"/Cart"},"Current Cart"),r.a.createElement("p",{onClick:this.signOut},"Logout"),r.a.createElement("br",null)))}}]),t}(n.Component),M=[],U=null,x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getCurrentUser=function(){c.auth().onAuthStateChanged(function(e){e&&a.setState({user:c.auth().currentUser},a.stateIsSet)})},a.handleOnClick=function(){a.setState({redirect:!0})},a.stateIsSet=function(){c.database().ref().child("customers").child(a.state.user.uid).child("orders").on("child_added",function(e){var t=e.val();M.push(t),a.setState({orders:M})})},a.state={user:{},orders:[]},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.getCurrentUser(),this.setState({orders:null}),M=[]}},{key:"render",value:function(){return M.length>0?(M.reverse(),U=M.map(function(e,t){return r.a.createElement("div",{className:"orderDetails",key:t},r.a.createElement("div",{className:"orderHeader"},"Order from ",e.orderDate),r.a.createElement("ul",null,Object.keys(e.productsInOrder).map(function(t,a){return r.a.createElement("li",{key:a},r.a.createElement("span",{className:"itemName"},t),r.a.createElement(S.a,{value:e.productsInOrder[t],displayType:"text",thousandSeparator:!0,prefix:"$",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return r.a.createElement("span",{className:"itemPrice"},e)}}))})),r.a.createElement("div",{className:"orderPrice"},r.a.createElement(S.a,{value:e.totalPrice,displayType:"text",thousandSeparator:!0,prefix:"$",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return r.a.createElement("div",null,"Total Order Price: ",e)}})))}),r.a.createElement("div",null,U)):r.a.createElement("div",null,r.a.createElement("h2",{id:"ordersNote"},"You have no past orders yet"))}}]),t}(n.Component),D=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"main"},r.a.createElement("h2",{id:"pastOrders"},"Order History"),r.a.createElement(x,null))}}]),t}(n.Component),T="",z="",R={},B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).componentWillUnmount=function(){a._isMounted=!1,a.setState({user:R,email:a.state.email,password:a.state.password})},a.signInUser=function(e){e.preventDefault();var t=a.state.email,n=a.state.password;if(console.log("Email: "+T),console.log("Password: "+z),a.setState({errorMsg:""}),""===t||""===n)a.setState({errorMsg:"Please fill all fields."});else{var r=Object(k.a)(Object(k.a)(a));c.auth().signInWithEmailAndPassword(t,n).catch(function(e){r.setState({errorMsg:e.message})}),c.auth().onAuthStateChanged(function(e){e&&(console.log(e),R=e,a._isMounted&&a.setState({redirect:!0}))})}},a.createUser=function(e){e.preventDefault(),a.setState({redirect_createAcc:!0})},a.state={email:"",password:"",user:{},redirect:!1,redirect_createAcc:!1,errorMsg:""},a.handleInputChange=a.handleInputChange.bind(Object(k.a)(Object(k.a)(a))),a.handlePasswordChange=a.handlePasswordChange.bind(Object(k.a)(Object(k.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"handleInputChange",value:function(e){this.setState({email:e.target.value},function(){T=this.state.email})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value},function(){z=this.state.password})}},{key:"render",value:function(){return this.state.redirect?r.a.createElement(f.a,{push:!0,to:{pathname:"/",state:{user:this.state.user,loggedIn:!0}}}):this.state.redirect_createAcc?r.a.createElement(f.a,{push:!0,to:{pathname:"/CreateAccount/",state:{email:this.state.email,password:this.state.password}}}):this.state.errorMsg?r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"sign-up-container"},r.a.createElement("form",null,r.a.createElement("input",{type:"email",className:"field",id:"email",defaultValue:this.state.email,placeholder:"Email",onChange:this.handleInputChange,autoComplete:"email"}),r.a.createElement("p",{className:"errormsg",id:"email_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"password",defaultValue:this.state.password,placeholder:"Password",onChange:this.handlePasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"},this.state.errorMsg),r.a.createElement("div",{className:"formButtons"},r.a.createElement("button",{onClick:this.signInUser,className:"formBtn signIn"},"Sign In"),r.a.createElement("button",{onClick:this.createUser,className:"formBtn createAccount"},"Create Account"))))):r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"sign-up-container"},r.a.createElement("form",null,r.a.createElement("input",{type:"email",className:"field",id:"email",defaultValue:this.state.email,placeholder:"Email",onChange:this.handleInputChange,autoComplete:"email"}),r.a.createElement("p",{className:"errormsg",id:"email_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"password",defaultValue:this.state.password,placeholder:"Password",onChange:this.handlePasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"},r.a.createElement("br",null)),r.a.createElement("div",{className:"formButtons"},r.a.createElement("button",{onClick:this.signInUser,className:"formBtn signIn"},"Sign In"),r.a.createElement("button",{onClick:this.createUser,className:"formBtn createAccount"},"Create Account")))))}}]),t}(n.Component),V="",H="",F="",W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).createUser=function(e){e.preventDefault();var t=a.state.email,n=a.state.password,r=a.state.passwordRepeat;if(console.log("Email: "+V),console.log("Password: "+H),console.log("Repeat Password: "+F),a.setState({errorMsg:""}),""===t||""===n||""===r)a.setState({errorMsg:"Please fill all fields."});else if(n!==r)a.setState({errorMsg:"Passwords do not match."});else{var s=Object(k.a)(Object(k.a)(a));c.auth().createUserWithEmailAndPassword(t,n).catch(function(e){s.setState({errorMsg:e.message})}),c.auth().onAuthStateChanged(function(e){e&&(e=c.auth().currentUser,a.writeUserData(e))}),c.auth().onAuthStateChanged(function(e){e&&(console.log(e),a._isMounted&&a.setState({redirect:!0}))})}},a.state={email:"",password:"",passwordRepeat:"",redirect:!1,errorMsg:""},a.handleInputChange=a.handleInputChange.bind(Object(k.a)(Object(k.a)(a))),a.handlePasswordChange=a.handlePasswordChange.bind(Object(k.a)(Object(k.a)(a))),a.handleRepeatPasswordChange=a.handleRepeatPasswordChange.bind(Object(k.a)(Object(k.a)(a))),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.setState({email:this.props.location.state.email,password:this.props.location.state.password})}},{key:"handleInputChange",value:function(e){this.setState({email:e.target.value},function(){V=this.state.email})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value},function(){H=this.state.password})}},{key:"handleRepeatPasswordChange",value:function(e){this.setState({passwordRepeat:e.target.value},function(){F=this.state.passwordRepeat})}},{key:"writeUserData",value:function(e){c.database().ref("customers/"+e.uid).set({email:e.email,name:"",shippingAddress:{streetAddress:"",city:"",state:"",zip:"",country:""}})}},{key:"render",value:function(){return this.state.redirect?r.a.createElement(f.a,{push:!0,to:"/Account/"}):this.state.errorMsg?r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"sign-up-container"},r.a.createElement("form",null,r.a.createElement("input",{type:"email",className:"field",id:"email",defaultValue:this.props.location.state.email,placeholder:"Email",onChange:this.handleInputChange,autoComplete:"email"}),r.a.createElement("p",{className:"errormsg",id:"email_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"password",defaultValue:this.props.location.state.password,placeholder:"Password",onChange:this.handlePasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"repeat_password",defaultValue:"",placeholder:"Repeat Password",onChange:this.handleRepeatPasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"},this.state.errorMsg),r.a.createElement("div",{className:"formButtons"},r.a.createElement("button",{onClick:this.createUser,className:"formBtn createAccount"},"Create Account"))))):r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"sign-up-container"},r.a.createElement("form",null,r.a.createElement("input",{type:"email",className:"field",id:"email",defaultValue:this.props.location.state.email,placeholder:"Email",onChange:this.handleInputChange,autoComplete:"email"}),r.a.createElement("p",{className:"errormsg",id:"email_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"password",defaultValue:this.props.location.state.password,placeholder:"Password",onChange:this.handlePasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"}),r.a.createElement("input",{type:"password",className:"field",id:"repeat_password",defaultValue:"",placeholder:"Repeat Password",onChange:this.handleRepeatPasswordChange,autoComplete:"current-password"}),r.a.createElement("p",{className:"errormsg",id:"password_error_1"},r.a.createElement("br",null)),r.a.createElement("div",{className:"formButtons"},r.a.createElement("button",{onClick:this.createUser,className:"formBtn createAccount"},"Create Account")))))}}]),t}(n.Component),q=[],Q={},L=new Map,$=0,G=[],Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getCurrentUser=function(){c.auth().onAuthStateChanged(function(e){e&&a.setState({user:c.auth().currentUser},a.stateIsSet)})},a.stateIsSet=function(){var e=c.database().ref().child("customers").child(a.state.user.uid).child("cart");q=[],a.getCurrentOrders(),e.on("child_added",function(e){var t=e.key,n=e.val(),r=Object(k.a)(Object(k.a)(a));c.database().ref("/products/").child(t).once("value").then(function(e){if((Q=e.val()).key=t,Q.quantity=n,console.log(Q),Q.onHand<n&&Q.onHand>0){var a=n-Q.onHand;1===a?alert(a+' "'+Q.name+'" was removed from the cart. Not enough remain.'):alert(a+' "'+Q.name+'"s were removed from the cart. Not enough remain.'),q.push([t,Q.onHand,Q]);var s={};s["/customers/"+r.state.user.uid+"/cart/"+t]=Q.onHand,c.database().ref().update(s)}else Q.onHand<=0?(alert(Q.name+" was removed from the cart. None remain."),r.removeFromCart(t)):q.push([t,n,Q]);r.setState({cartItems:q},r.calculateOrderTotal())})})},a.removeFromCart=function(e){var t=Object(k.a)(Object(k.a)(a));c.database().ref("customers/"+a.state.user.uid+"/cart/"+e).remove().then(function(){for(var a=[],n=0;n<q.length;n++)q[n][0]!==e&&a.push(q[n]);q=a,a=[],Q={},t.setState({cartItems:q},t.calculateOrderTotal)}).catch(function(e){console.log("Remove failed: "+e.message)})},a.emptyCart=function(){var e=Object(k.a)(Object(k.a)(a));c.database().ref("customers/"+a.state.user.uid+"/cart/").remove().then(function(){q=[],Q={},e.setState({cartItems:[]},e.calculateOrderTotal)}).catch(function(e){console.log("Remove all failed: "+e.message)})},a.calculateOrderTotal=function(){$=0;for(var e=q.length,t=0;t<e;t++){var n=q[t][2].price,r=parseInt(q[t][1]);$+=n*r}a.setState({orderTotal:$})},a.getCurrentOrders=function(){var e=Object(k.a)(Object(k.a)(a));c.database().ref("/customers/"+a.state.user.uid).once("value").then(function(t){var a=t.val();G=a.orders,e.setState({orders:a.orders})})},a.addOrderToAccount=function(){if(a.state.cartItems.length>0){void 0===a.state.orders&&(G=[]),G.push(a.createNewOrder()),a.setState({orders:G});var e={};e["/customers/"+a.state.user.uid+"/orders/"]=G,c.database().ref().update(e),alert("Order completed successfully. Thank you for your business!"),a.changeProductQuantities(),a.emptyCart()}},a.changeProductQuantities=function(){var e={},t=0,a=0,n=0,r=0;c.database().ref("/products/").once("value").then(function(s){for(var l=0;l<q.length;++l)t=q[l][2].onHand,n=q[l][2].quantity,a=q[l][0],r=t-n,e["/products/"+a+"/onHand/"]=r;c.database().ref().update(e)})},a.state={redirect:!1,user:{},cartItems:[],orderTotal:0,orders:[]},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.getCurrentUser()}},{key:"createNewOrder",value:function(){var e={},t=new Date;t=t.toDateString();for(var a=0;a<q.length;++a){var n=q[a];e[n[2].name]=n[2].price}return{orderDate:t,productsInOrder:e,totalPrice:this.state.orderTotal}}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(f.a,{push:!0,to:"/SignIn/"}):(L=q.map(function(t){return r.a.createElement("tr",{key:t[0]},r.a.createElement(p.b,{to:"/Product/".concat(t[0])},r.a.createElement("td",null,r.a.createElement("img",{src:t[2].imgUrl,className:"thumbnail",alt:""}))),r.a.createElement("td",null,t[2].name),r.a.createElement("td",null,t[2].description),r.a.createElement("td",null,t[1]),r.a.createElement("td",null,r.a.createElement(S.a,{value:t[2].price,displayType:"text",thousandSeparator:!0,prefix:"$",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return r.a.createElement("div",null,e)}})),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return e.removeFromCart(t[0])},className:"checkoutBtn"},"Remove")))}),r.a.createElement("div",{className:"main"},r.a.createElement("button",{className:"checkoutBtn",onClick:function(){return e.addOrderToAccount()}},"Proceed to Checkout"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Image"),r.a.createElement("th",null,"Item Name"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Quantity"),r.a.createElement("th",null,"Price"),r.a.createElement("th",null,"Action")),L,r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("p",null,r.a.createElement("b",null,"Order Total:")),r.a.createElement(S.a,{value:this.state.orderTotal,displayType:"text",thousandSeparator:!0,prefix:"$",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return r.a.createElement("div",null,e)}})),r.a.createElement("td",null," ",r.a.createElement("button",{onClick:function(){return e.emptyCart()},className:"checkoutBtn emptyCartBtn"},"Empty Cart")))))))}}]),t}(n.Component),J=a(57),K=a.n(J),X=a(75),Z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getCurrentProduct=Object(X.a)(K.a.mark(function e(){var t,n;return K.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=c.database().ref(),n=t.child("products"),n.child(a.props.match.params.key).once("value").then(function(e){console.log(e.val()),a.setState({product:{description:e.child("description").val(),name:e.child("name").val(),imgUrl:e.child("imgUrl").val(),onHand:e.child("onHand").val(),price:e.child("price").val()}})});case 4:case"end":return e.stop()}},e)})),a.componentDidMount=function(){a.getCurrentProduct()},a.state={key:0,product:{}},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log(this.state.product),this.state.product==={}?r.a.createElement("div",null,r.a.createElement("p",null,"Loading Product")):r.a.createElement("div",{className:"product-container"},r.a.createElement("div",{className:"product-image-container"},r.a.createElement("h1",null,this.state.product.name),r.a.createElement("img",{src:this.state.product.imgUrl,className:"largeImage",alt:""})),r.a.createElement("div",{className:"product-description"},r.a.createElement("p",null,"Quantity Remaining: ",this.state.product.onHand),r.a.createElement("p",null,"Price: $",this.state.product.price),r.a.createElement("p",null,this.state.product.description)))}}]),t}(n.Component),ee=function(){return r.a.createElement("div",{className:"main"},r.a.createElement("h2",null,"Error"),r.a.createElement("p",null,"Something went wrong!"))},te=(a(145),function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement("div",null,r.a.createElement(w,null),r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/",exact:!0,component:A}),r.a.createElement(f.b,{path:"/Cart/",component:Y}),r.a.createElement(f.b,{path:"/Account/",component:_}),r.a.createElement(f.b,{path:"/Orders/",component:D}),r.a.createElement(f.b,{path:"/SignIn/",component:B}),r.a.createElement(f.b,{path:"/CreateAccount/",component:W}),r.a.createElement(f.b,{path:"/Product/:key",component:Z}),r.a.createElement(f.b,{component:ee}))))}}]),t}(n.Component));c.apps.length||c.initializeApp(o),l.a.render(r.a.createElement(te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},76:function(e,t,a){e.exports=a(146)}},[[76,1,2]]]);
//# sourceMappingURL=main.98ac0859.chunk.js.map